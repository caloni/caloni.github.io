<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Blogue do Caloni</title>
<meta name="author" content="" />
<meta name="generator" content="Hugo 0.110.0">
<meta property="og:title" content="Blogue do Caloni"/>
<meta property="og:type" content="website"/>
<meta property="og:url" content="http://www.caloni.com.br/"/>
<meta property="og:image" content="/img/author.jpg"/>
<meta property="og:description" content=""/>
<link href="/index.xml" rel="feed" type="application/rss+xml" title="Blogue do Caloni"/>
<link rel="stylesheet" type="text/css" href="/css/custom.css"/>
<link rel="stylesheet" type="text/css" href="/css/jquery-ui.css"/>
<link rel="stylesheet" type="text/css" href="/css/board-min.css"/>
<script src="/js/jquery-1.10.2.js"></script>
<script src="/js/jquery-ui.js"></script>
<script src="/js/pgnyui.js"></script>
<script src="/js/pgnviewer.js"></script>
<script>
var quick_search_posts = [ 
 ]; 
</script>
<script src="/js/quick_search.js"></script>
<script src="/js/list.js"></script>
<link rel="icon" href="/img/favicon.ico"/>
</head>
<body style="min-height:100vh;display:flex;flex-direction:column">
<nav class="navbar has-shadow is-white"
role="navigation" aria-label="main navigation">
<div class="container">
<div class="navbar-brand">
<pre><span style="font-size: 3px; margin: 0; display: block;">

&amp;*/. .*%@@@@@@@@@@@@&amp;/    , &amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@#,*@@@@%,*&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@@@@@@./@.(@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@**#./((,*, *./((*,#,&amp;@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@.#@@%&amp;@@* (@@%&amp;@@/#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@,#@@&amp;&amp;@@, (@@&amp;&amp;@@*#@@@@@@@@@@@@@#/,,.         ..,/#&amp;@@@@@@@@@@@@@@@@@@@@@@@
@@@@@&amp;, .//      .//  .%@@@@@@&amp;#.  .,****.,*************,.  .(&amp;@@@@@@@@@@@@@@@@@
@@@*                     ,@/  .**,,,*********,   ,***,   ****    *@@@@@@@@@@@@@@
@#                         ,***      .******       ,***,*****,      *&amp;@@@@@@@@@@
&amp;                           ,**      .******.     .******************  (@@@@@@@@
                             ****..,*************************,    ,***   (@@@@@@
@@@@#,,,,,,,,,,,,,,,,,,,,*********,   ,**************,  .***,      .**. .  %@@@@
@@@@%                   .***,.,****,.,***,     ,****      ***.     ,******, /@@@
@@@@@&amp;.                ,**       *******,       *****,  .******************, *@@
@@@@@@@&amp;,            ,****      .********,.   .*************,  ,*****,    ,** /@
@@@@@@@@@@@@&amp;/ .****,    ************.   ****************************      **. #
@@@@@@@@@@@@@, *****,    ,***********    .******,   ,****.   .*****,***,,***** ,
@@@@@@@@@@@@&amp;..**************,  ,***********************       ,*,    ********..
@@@@@@@@@@@@&amp; ,**.    ,******.  .*******.    .**********,     .**********. .**, 
@@@@@@@@@@@@% ,*       ,***************.      .*****************************,   
@@@@@@@@@@@@@&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;@,(&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;#*@&amp;&amp;&amp;@*#&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;
@@@@@@@@@@@@@@@@@@@@@@@@@@@@(.#@@@@(.#@@@@@@@@@@@@@@@@@@@@@#**@@@@(.#@@@@@@@@@@@

</span></pre>
&nbsp;
<a class="navbar-item" href="months.html">
<div class="is-4">caloni::2023-08</div>
</a>
</div>
</div>
</nav>
<div class="container">
<div class="column">
<div style="min-height:56vh">
<div style="padding-bottom: 1em;"></div>
<ul style="list-style: none;">
<li><small><a href="2023-08.html#brincando-com-fogo">Brincando com Fogo</a></small></li>
<li><small><a href="2023-08.html#anime-de-zumbi">Bucket List of the Dead</a></small></li>
<li><small><a href="2023-08.html#cafe-pretissimo">Café Pretíssimo</a></small></li>
<li><small><a href="2023-08.html#degustacao-cervejas-mercado">Degustação de Cervejas de Mercado</a></small></li>
<li><small><a href="2023-08.html#descobrindo-ativacao-classes-winrt">Descobrir ativação de classes WinRT</a></small></li>
<li><small><a href="2023-08.html#as-orfas-da-rainha">As Órfãs da Rainha</a></small></li>
<li><small><a href="2023-08.html#chungking-express-amores-expressos">Chungking Express</a></small></li>
<li><small><a href="2023-08.html#ja-pias-meia-garrafa-portugues">Já Pias 375 mL</a></small></li>
<li><small><a href="2023-08.html#oppenheimer">Oppenheimer</a></small></li>
<li><small><a href="2023-08.html#vinia-le-fruite-2021-frances">Vinia Le Fruité I.G.P. Pays d'Oc 2021</a></small></li>
<li><small><a href="2023-08.html#eami">Eami</a></small></li>
<li><small><a href="2023-08.html#blogawk">Finalmente blogawk</a></small></li>
<li><small><a href="2023-08.html#hstring">Explorando a HSTRING</a></small></li>
<li><small><a href="2023-08.html#repaginada-do-mes">Muitos animes, lugares e séries</a></small></li>
</ul>


<span id="anime-de-zumbi" title="Bucket List of the Dead"/></span>
<section>
<p class="title"><a href="2023-08.html#anime-de-zumbi">#</a> Bucket List of the Dead</p>
<p class="note-title"><small>2023-08-02  <a href="animes.html">animes</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>A ideia é bem boa. Garoto trabalha como um morto-vivo para uma empresa exploradora e quando começa o apocalipse zumbi ele renasce. E vai comprar umas brejas de bike no meio da horda dos novos mortos-vivos. No entanto, por ser um anime adolescente ele perde pontos. É muita enrolação. O conceito é uma bucket list que o jóvi preenche de coisas que ele quer fazer e nunca teve tempo ou chance ou aquelas desculpas que damos a nós mesmos. A analogia pós-pandemia é muito óbvia. A graça é que é como se ele estivesse em pleno lockdown. Eu lembro minha felicidade nerd na época do coronga, que sabia que não viveria um apocalipse, mas que o vírus era o acontecimento mais próximo disso e estava de bom tamanho. Esta série tem alto astral. Se você é jóvi e se ficar na moda vai curtir.</p>
</section><hr/>

<span id="brincando-com-fogo" title="Brincando com Fogo"/></span>
<section>
<p class="title"><a href="2023-08.html#brincando-com-fogo">#</a> Brincando com Fogo</p>
<p class="note-title"><small>2023-08-02  <a href="series.html">series</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Esta novela japonesa chega a ser um pouco engraçada, mas é involuntário. Seu elenco é tão caricato. Será influência de anime? O roteiro não ajuda também. Sem conexão com reais personagens de um drama, a história de investigação de uma filha em busca da verdade para sua debilitada mãe por um acontecimento do passado apresenta personagens estereotipados até o talo. É um exagero estilizado (como certos animes) com trilha sonora moderninha. Não chega a ser curiosa esta versão pop dos valores nipônicos.</p>
</section><hr/>

<span id="cafe-pretissimo" title="Café Pretíssimo"/></span>
<section>
<p class="title"><a href="2023-08.html#cafe-pretissimo">#</a> Café Pretíssimo</p>
<p class="note-title"><small>2023-08-02  <a href="coffee.html">coffee</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Como regra de ouro aumentar o grau da torra diminui a acidez e aumenta o amargor. Minha amiga me deu um café em grãos absolutamente preto, pretíssimo, pretérrimo. É para os produtores da Netflix derramarem lágrimas sobre ele. Vocês não têm ideia. Esse café é muito preto. Fiquei com muito medo dele.</p>
<p>Eu já fiz uma torra assim em casa. Umas das primeiras, empestiei a cozinha e cometi o deslize de queimar. Pois é, queimar a torra, que absurdo. Isso acontece quando não se diminui a temperatura dos grãos em tempo hábil. Em questão de segundos eles passam do ponto, o que quer dizer que no copo fica um amargo além da conta e com sabor queimado. Não bom.</p>
<p>Outra característica das torras bem escuras é sua superfície oleosa, pois depois de certa temperatura a gordura começa a sair de dentro do grão. Interessante que estes grãos não estão assim. Apenas há uma sujeira em torno deles que lembra fuligem. Ao passar os dedos uma espécie de fuligem fica impregnada na pele.</p>
<p>Fiz o primeiro teste com 12g para 200g de água. A mesma coisa que surpreendeu minha amiga me deixou encafufado: doze gramas desses grãos são o dobro do volume de outros grãos. Nunca tinha visto isso.</p>
<p>O resultado no copo ficou equilibrado. Como previsto para essa torra, seu corpo é leve, mas diferente do esperado no sabor, não senti muito amargor. É um sabor intenso de tons aveludados bem simples, que combina com o aroma do pó. Sua cor é preta, pretíssima, pretérrima.</p>
<p>Minha segunda tentativa de passar este café foi no pano, em um pó um pouco mais grosso e uma pré infusão de alguns minutinhos. O resultado dessa vez ficou muito mais forte. Chegou a dar um barato no cérebro. Não chega a ser o amargor que se intensifica, mas talvez os outros sabores se tornam perenes demais na boca. Eles não são exatamente desagradáveis, mas também não são muito desejados. Pelo menos para mim. É um desafio. Me sinto naqueles vídeos do James Hoffman onde ele prova um pó de café guardado desde os anos 50, mas com a diferença que nesse caso é bebível. Degustável já é controverso.</p>
<p>Meu próximo teste foi passar em filtro de papel. Pensei nisso por causa da cor que esse papel irá ficar. Quase aquelas folhas de papel carbono, imaginei. E de fato, sim, foi interessante. O sabor ficou muito próximo entre os três métodos, mas sempre havia alguma coisa mais ou menos forte entre elas. No caso do filtro de papel a pouca acidez conseguiu ficar mais acentuada. Porém, ainda assim, o amargor ganha. Isso e o soco no estômago que é este grão.</p>
<p>Fiz um experimento com a prensa francesa. Após moer para prensa usei uma peneira para tirar os fines e daí coloquei em infusão por 5 minutos. Com os fines que ficaram após peneirar usei a Aeropress. Comparei os resultados. Esse café tem um saborzinho ao fundo que pode ser traduzido como "verde". Na passagem da Aeropress ele continuou bem presente, mas na prensa ele quase sumiu. Foi possível assim sentir um pouco mais de doçura na versão com moagem mais grossa, pois na versão original a língua estava muito ocupada (certeza que irão fazer piada disso) tentando entender o tom "verde" para prestar atenção em doçura. Não é uma grande diferença, mas é algo a se notar se você prefere seu café mais suave. Se é que podemos falar de suave em um café como esse, preto, pretésimo, pretérrimo.</p>
<p>O experimento final foi moer os grãos para prensa francesa e deixar em infusão por 5 minutos para em seguida passar pelo Aeropress. Sem peneirar os fines. O resultado foi o melhor até agora. O sabor "verde" ficou sob controle, assim como o amargor. Este é um café tipicamente amargo e você deve senti-lo na bebida; não faria sentido querer tirar algo que compõe seu sabor. Porém, para sentir o resto dos sabores é crucial mantê-lo sob controle. E eu acho que essa receita conseguiu o feito.</p>
</section><hr/>

<span id="degustacao-cervejas-mercado" title="Degustação de Cervejas de Mercado"/></span>
<section>
<p class="title"><a href="2023-08.html#degustacao-cervejas-mercado">#</a> Degustação de Cervejas de Mercado</p>
<p class="note-title"><small>2023-08-02  <a href="beer.html">beer</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Provei algumas cervejas de latinha antes de um churrasco para decidir qual levar. Foram: Budweiser Pilsen, Spaten, Colorado Lager, Patagônia Amber Lager e Brahma Puro Malte. Dividi essa tarefa por três dias. Algumas foram mais doces, outras mais encorpadas. Algumas notava-se mais cremosidade ou mais ou menos everfescência. Minha conclusão foi que todas eram ótimas, algumas mais enjoativas que outras, e no dia mesmo eu peguei mais uma penca de cervejas diferentes. Ganhei gosto em pegar sortida.</p>
<p>No dia seguinte teve outro churrasco e peguei mais três rótulos distintos: Brahma Tostada Caramelizada, Brahma Black em Latinha e Therezópolis. As Brahmas destoavam bastante. A caramelizada aparentava ser mais doce, mas ao mesmo tempo mais cremosa, o que tirava um pouco o doce. A Black era chapada, sem muita espuma. Pode ser considerada sem graça por quem gosta da espuma.</p>
<p>A Therezópolis já conhecia, é um misto entre um pouco doce, mas encorpado e levemente amarga.</p>
</section><hr/>


<span id="descobrindo-ativacao-classes-winrt" title="Descobrir ativação de classes WinRT"/></span>
<section>
<p class="title"><a href="2023-08.html#descobrindo-ativacao-classes-winrt">#</a> Descobrir ativação de classes WinRT</p>
<p class="note-title"><small>2023-08-13  <a href="reversing.html">reversing</a> <a href="coding.html">coding</a> </small><a href="2023-08.html">^</a></p>

<p>A Windows Runtime nada mais é que o COM repaginado. O COM já previa o uso de proxies para comunicação remota entre processos. A WinRT adicionou mais uma interface e uma função. Vou neste post descrever o processo pelo qual descobri como funciona o registro de um dispositivo no Azure Active Directory (AAD).</p>
<p>O teste feito é logar no Microsoft Teams com uma conta de empresa pertencente a um domínio federado, o que significa que para fazer o login existe um plugin feito pela empresa que será carregado e autenticar o usuário. TL;DR isto é feito por um processo chamado `Microsoft.AAD.BrokerPlugin.exe`, que usa WinRT para se comunicar com o servidor AAD e com o sistema.</p>
<p>Analisando o disassembly pelo IDA e realizando algumas sessões de debug eu estava caminhando pela interface `IUserDeviceRegManagerStatics` que havia encontrado anteriormente. Eu sabia que essa interface estava por trás do registro da máquina porque depois que alguns de seus métodos são chamados o comando `dsregcmd.exe /status` lista o computador como joined dentro do AAD e se você for na parte de contas do usuário naquela tela de configurações do Windows irá aparecer a mesma conta usada para logar no Teams.</p>
<p>Buscando no registro pelo nome dessa interface existe uma entrada em `HKEY_CLASSES_ROOT\Interface\{b5decd05-58ef-4cd3-ae25-d177bcbcea9e}` aonde existe uma subkey `ProxyStubClsid32`. Essa subkey, de acordo com o <a href="https://learn.microsoft.com/en-us/windows/win32/com/proxystubclsid32">MSDN</a>, é usado para traduzir um IID -- ID de Interface -- para um CLSID -- ID de classe. Nas palavras do MSDN (em inglês, por favor): "Maps an IID to a CLSID in 32-bit proxy DLLs".</p>
<p>&gt;</p>
<p>&gt; If you add interfaces, you must use this entry to register them (32-bit systems) so that OLE can find the appropriate remoting code to establish interprocess communication.</p>
<p>&gt;</p>
<p>Eu acredito que a mesma lógica se aplica a ambientes de 64 bits, que é o caso do Windows 10 onde estou analisando.</p>
<p>Então esse ID é um CLSID para o código de um proxy que irá me ajudar a chamar esta interface `IUserDeviceRegManagerStatics`. Tudo bem, vamos lá. O valor default dentro dessa subkey é `{65704743-2513-4987-9fc9-826bbedde743}` e eu devo fazer a busca por este ID dentro de `HKEY_CLASSES_ROOT\CLSID`, já que se trata de um ID de classe. Eu encontro. O valor default dessa chave diz "UserDeviceRegistration", então eu penso ser este o cara que estou procurando.</p>
<p>Existe uma chave `InProcServer32` dentro desta chave. Novamente vamos à documentação, e de acordo com o <a href="https://learn.microsoft.com/en-us/windows/win32/com/inprocserver32">MSDN</a>:</p>
<p>&gt;</p>
<p>&gt; Registers a 32-bit in-process server and specifies the threading model of the apartment the server can run in.</p>
<p>&gt;</p>
<p>Isso faz todo o sentido, porque o valor default para esta mesma chave é "C:\Windows\System32\UserDeviceRegistration.dll"  e existe uma string `ThreadingModel` também especificando "Both". Olhando para as funções exportadas por esta DLL `UserDeviceRegistration.dll` são listadas as bem conhecidas `DllCanUnloadNow`, `DllGetActivationFactory` e `DllGetClassObject`. Isso é bê-a-bá de COM. O código que eu quero usar deve carregar esta DLL e chamar `DllGetActivationFactory` ou `DllGetClassObject` para obter um ponteiro para uma classe implementando esta interface ou um proxy para chamar esta classe remotamente.</p>
<p>Ao analisar pelo OleView pela `IUserDeviceRegManagerStatics` não há uma biblioteca de tipos com os nomes dos métodos e argumentos. Existe uma vtable genérica com algumas procedures chamadas "Proc1", "Proc2" e assim por diante. Já que desde minha sessão de debugging anterior eu vi um monte de funções RPC sendo chamadas eu irei assumir que `UserDeviceRegistration!DllGetActivationFactory` está sendo chamada. E, mais uma vez, de acordo com o <a href="https://learn.microsoft.com/en-us/previous-versions/br205771(v=vs.85">MSDN</a>), este entry point:</p>
<p>&gt;</p>
<p>&gt; Retrieves the activation factory from a DLL that contains activatable Windows Runtime classes.</p>
<p>&gt;</p>
<p>That's a bingo! Windows Runtime classes é o que estou procurando mesmo. Como eu já estudei anteriormente, isso bate com o retorno desta função: um ponteiro para a interface `IActivationFactory`. A entrada deste argumento é uma `HSTRING`, que é uma nova string definida pela Windows Runtime para strings imutáveis das linguagens mais populares, como C# e JS. E, mais uma vez, isso explica porque em minhas sessões de debug observei um monte de chamadas a `WindowsDeleteString`. Quando você começa a fazer reversa começa a ouvir ecos de sessões passadas para conseguir montar o quebra-cabeças.</p>
<p>Com tudo isso que descobri resolvi colocar um breakpoint no evento de load desta DLL.</p>
<pre>
sxe ld:UserDeviceRegistration.dll</pre>
<p>Repito o procedimento de registro de máquina e o breakpoint é ativado. Estou pronto para agora colocar um breakpoint na `DllGetActivationFactory`. Porém, tenho um insight neste momento. Eu me lembro que posso usar o Process Explorer para buscar no sistema inteiro quem é que está usando a mesma DLL que estou de olho. Afinal de contas, se ela é a interface para se comunicar com a implementação, faz sentido que dentro dela exista a implementação.</p>
<p>E com isso eu encontro a `RuntimeBroker.exe`, processo iniciado quase ao mesmo tempo que o BrokerPlugin. Coincidência? Acho que não.</p>
<p>Isso significa que agora eu posso depurar tanto o BrokerPlugin quanto a RuntimeBroker e usar os símbolos da DLL em comum para encontrar quais funções deverão ser chamadas de ambos os lados, já apostando que o método chave seria `CUserDeviceRegManagerStatic::WorkplaceJoin`, já que eu já encontrei este método em sessões passadas e seu nome faz todo sentido.</p>
<p>Na minha primeira tentativa o breakpoint não disparou. Busco, então, por nomes de funções semelhantes:</p>
<pre>
x UserDeviceRegistration!Windows::Internal::UserDeviceRegistration::CUserDeviceRegManagerStatic::*</pre>
<p>Já que estou interessado no macro coloco breakpoint em todos os métodos da classe. Faço isso também do lado do BrokerPlugin e seus métodos dentro de `UserDeviceRegistration::IUserDeviceRegManagerStatics`. Posso acompanhar o fluxo sem parar usando um parâmetro bem esperto nos breakpoints do WinDbg: um comando qualquer. Nesse caso uso imprimir o nome da função chamada e o comando `g`, que segue a execução sem parar. Por exemplos (RuntimeBroker e BrokerPlugin, respectivamente):</p>
<pre>
bp UserDeviceRegistration!Windows::Internal::UserDeviceRegistration::CUserDeviceRegManagerStatic::DelegatedWorkplaceJoinWithRequestId ".echotime; .echo UserDeviceRegistration!Windows::Internal::UserDeviceRegistration::CUserDeviceRegManagerStatic::DelegatedWorkplaceJoinWithRequestId; g"
bp AAD_Core!Windows::Internal::UserDeviceRegistration::IUserDeviceRegManagerStatics::GetJoinInfo ".echotime; .echo AAD_Core!Windows::Internal::UserDeviceRegistration::IUserDeviceRegManagerStatics::GetJoinInfo; g"</pre>
<p>Com isso eu descobri qual o processo e qual a classe envolvida neste processo de registro de máquina. Graças também aos símbolos disponibilizados pela Microsoft fica muito mais fácil entender o fluxo. Pretendo usar esta técnica mais vezes no futuro.</p>
</section><hr/>


<span id="as-orfas-da-rainha" title="As Órfãs da Rainha"/></span>
<section>
<p class="title"><a href="2023-08.html#as-orfas-da-rainha">#</a> As Órfãs da Rainha</p>
<p class="note-title"><small>2023-08-17  <a href="movies.html">movies</a> <a href="cinemaqui.html">cinemaqui</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Este segundo longa da cineasta Elza Cataldo (Vinho de Rosas) é antes de tudo um trabalho documental de uma época pouco vista na cinematografia brasileira. Estamos falando dos longínquos anos 1580 e seus esparsos imigrantes; a maioria está lá por sentença, ainda que alguns vendidos pela chance do novo mundo.</p>
<p>O filme recria este ambiente e os ânimos dos locais, começando pelas pessoas menos satisfeitas por estarem lá: as mulheres de Portugal. Há três delas, irmãs. As duas mais velhas já vieram encomendadas para formar família. A mais nova não: ela tem o pé defeituoso e nenhuma serventia. Então ela fica na igreja com um padre que se sente guardião da moral entre os poucos habitantes de Vila Morena e os nativos em volta. Não demora muito para ela começar a desenhar sua arte e ter uma paixonite por um indiozinho de fala mansa.</p>
<p>O trabalho histórico no filme é impressionante, ainda mais por se tratar de uma produção nacional. Não estamos acostumados a épicos que resgatam o início de nossa brasilidade, e todo o afinco e detalhes em narrar esta passagem aumenta a imersão.</p>
<p>As atuações são precisas, beneficiadas por diálogos que aumentam nossa compreensão dos valores daquela sociedade. Existe um quê teatral que ofusca o realismo que é tão curioso quanto os efeitos de computação gráfica que surgem; na maioria gratuitos, exceto pela morte de uma criança.</p>
<p>Outro detalhe que soa condescendente com o espectador contemporâneo são as cenas de violência cotidiana daquela época, que no filme ocorrem fora de quadro. É de bom tom, mas suaviza a brutalidade, se aproximando de uma novela da vida privada e se afastando do seu potencial de provocar. Ser um filme lembrado por mais tempo do que o tempo de sua produção (mais de uma década) deveria ser um objetivo desejável.</p>
<p>Por falar nisso, suas filmagens terminaram assim que os casos de COVID começaram no Brasil, e todos os meses de preparo da pré-produção se pagaram, pois o trabalho após filmado ocorreu remotamente, quando já havia uma alma construída, idealizada com muito esmero por Cataldo.</p>
<p>Apesar da longa duração e o ritmo procaico o filme passa rápido, mas não o suficiente para seu terceiro ato, que soa arrastado não pelo conteúdo, mas por não esperarmos por todo um episódio final envolvendo a chegada da Santa Inquisição e o julgamento dos moradores da Vila. Essa parte também é um primor de detalhes documentais; quase não deixa escapar a visão parcial de lados e a defesa ferrenha de opinião que estamos acostumados a perceber em produções de viés social. Só que este longo processo que transforma amigos e conhecidos em traidores uns dos outros para salvarem sua pele não acompanha o ritmo do espectador. Por outro lado, lembra um pouco as farpas trocadas na pandemia, que dividiu por completo as pessoas.</p>
<p>Se eu fosse você eu assistiria este filme no cinema. É muito difícil na vida moderna do sofá de casa ou dos gadgets na palma do mão escapar do ritmo alucinante de luzes piscando. Este trabalho histórico merece uma imersão que não está disponível em streaming. Exceto, talvez, em sua revisita.</p>
</section><hr/>

<span id="chungking-express-amores-expressos" title="Chungking Express"/></span>
<section>
<p class="title"><a href="2023-08.html#chungking-express-amores-expressos">#</a> Chungking Express</p>
<p class="note-title"><small>2023-08-17  <a href="movies.html">movies</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Não são fascinantes as rimas que encontramos pelo cinema? Esta Amelie Poulain nasceu antes mesmo que a original, em 1994. É a gamine mais espontânea de todos os tempos. Isso porque ela não é atriz de verdade, mas a cantora mais famosa de Hong Kong. Ela dança ao som de California Dreamin' e canta sua própria versão de Dreams (The Cranberries). Faye Yong é a alma de um projeto de baixo orçamento, introduzida em seu filme pelo diretor Wong Kar Wai como um estabanado, o que não é costume do cineasta e que ajuda a explicar o caos interno da personagem e das filmagens com uma improvisadora por vocação.</p>
<p>E esta é apenas a segunda e mais comportada metade do filme. Em sua primeira parte existe mais ação, com tiros inclusive, em uma metrópole que não liga para corações atribulados, que mesmo assim insistem em bater. Curiosamente ambos os corações masculinos são de policiais. E mais curioso ainda é a breguice do primeiro.</p>
<p>Seu nome é He Qiwu e ele termina com uma garota chamada May no dia primeiro de abril. Quer dizer, ela termina com ele. Para ele se certificar que ela de fato o abandonou, ele compra uma lata de abacaxi por dia, a fruta favorita dela, até que ela retorne. Ou ela retorna ou todas as latas irão vencer no dia do aniversário dela: primeiro de maio. Em uma história paralela uma peruca loira de óculos escuros inclusive à noite foge pelas ruas depois que um plano de contrabando envolvendo indianos termina mais azedo que os abacaxis do policial. Tiros são trocados neste episódio mais almodovariano da carreira do diretor asiático. É charmoso, bagunçado, clichê e adorável.</p>
<p>Tudo isso empalidece quando começa a história de Faye Wong e sua paixonite pelo segundo policial do longa, que também levou um fora de sua garota, uma comissária de bordo, muito boa por sinal. Assim como ela, Faye mantém sua cabeça nos ares, mas com os pés fincados em terra firme, e invade a casa do moço e cuida dela como se já fosse sua. E eis que nasce a inspiração de Jean-Pierre Jeunet para a icônica versão francesa. E o policial acompanha, batendo um papo com os objetos da casa que um dia foram os participantes de uma história de amor.</p>
<p>Os movimentos de câmera do filme são frenéticos e acompanham os personagens com energia. Há cenas no começo que evocam isso, pois elas ficam borradas. Há um quê de experimentação, curiosa porque podemos observar traços de uma filmografia pautada nos solitários e as paixões não correspondidas. Uma oportunidade única para entender a evolução das rimas do cinema.</p>
</section><hr/>

<span id="ja-pias-meia-garrafa-portugues" title="Já Pias 375 mL"/></span>
<section>
<p class="title"><a href="2023-08.html#ja-pias-meia-garrafa-portugues">#</a> Já Pias 375 mL</p>
<p class="note-title"><small>2023-08-17  <a href="wine.html">wine</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Além do Wine ter me enganado no sistema de assinaturas ainda oferece meia-garrafa em sua loja sem avisar corretamente. Nunca imaginei que essas lojas ofertasssem esse tipo de garrafa para entrega. Meia-garrafa na minha concepção é para comprar no mercado porque você vai beber vinho sozinho para acompanhar a pizza. O Já Pias, apesar da conotação, não é tão ruim assim. Ele é bebível. "Uma raridade", diz o sommelier do Wine. Eles sabem vender suco de uva estragado. No entanto, para um vinho português achei bem bom. Os taninos são macios, mesmo.</p>
</section><hr/>

<span id="oppenheimer" title="Oppenheimer"/></span>
<section>
<p class="title"><a href="2023-08.html#oppenheimer">#</a> Oppenheimer</p>
<p class="note-title"><small>2023-08-17  <a href="movies.html">movies</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Tarde de solteiro, resolvi dar uma ida e volta ao cinema de caminhada. Pensei que teria muito a refletir na volta. Estava lembrando na ida da última vez que fiz isso e assisti sem pretensão o maravilhoso Tudo, No Mesmo Lugar, Ao Mesmo Tempo. Qual seria o filme escolhido dessa vez?</p>
<p>Oppenheimer, é claro. Eu assistiria Barbie, mas já está prometido para ver com a Mitiko. De qualquer forma seria um dos dois. O motivo é que ambos são um dueto de um meme que se espalhou em 2023. Tanto que ambos os filmes tiveram bilheterias significativa nas estreias.</p>
<p>Porém, por via das dúvidas, fui comprar pipoca. Desde a bagunça de Tennet, nunca se sabe o que o diretor Christopher Nolan pode aprontar. Na direção e no roteiro. Então, que pelo menos a pipoca seja boa. Sem contar que são três horas de duração.</p>
<p>Escolho um cinema com os efeitos porque meu amigo me disse que era importante. Hoje eu entendo para que serviriam nesse caso: para disfarçar a quantidade de vergonha alheia que vai vindo aos borbotões conforme assisto a uma lástima de cinema.</p>
<p>A começar pelas falas. Nolan tem um elenco de peso, das antigas, e não entrega um diálogo sequer que não te faça pensar "o que eu estou fazendo aqui". Os únicos minutos em que o filme faz algum sentido é na introdução, os primeiros quinze minutos. Faz sentido e é agradável ser apresentado aos poucos às mentes brilhantes daquela época.</p>
<p>Ao final, se você se lembrar que a primeira cena é Oppenheimer olhando para gotas de água caindo em um lago, vai perceber que sua última cena sequer rima. Se você for um espectador autista ainda pode observar que antes do teste da bomba de Los Alamos choveu torrencialmente, o que faria rima com a vinda da guerra fria e suas ameaças de bombas de todos os lados e os delírios do cientista em vislumbrar este futuro e... não, chega. Você não precisa disso. Ninguém precisa disso.</p>
<p>A impressão após assistir a Oppenheimer é de que o mundo não precisa de um filme sobre esses fatos históricos conforme descritos, em estilo documental e ao mesmo tempo thriller de ação psicológica ou o que seja. Assim como o final da guerra não precisava dessa demonstração de forças irracional e desproporcional. No entanto, aí estão as mazelas das bombas, por gerações. O aí está o filme. A vantagem do filme é que ele só será lembrado este ano. E olha lá. Só por causa dos memes.</p>
<p>Nolan gosta de testar coisas novas no cinema, e isso é admirável. Ele quis uma produção "modesta" que poderia evocar parte do charme visto em Dunkirk se não fosse pelas distrações narrativas, cuja divisão de tempos para criar uma espécie de suspense eu nem vou comentar de tão incômodo que foi.</p>
<p>Queria mais comentar um dos maiores equívocos deste diretor que hora flerta de Kubrick, hora de Hitchcock, mas nos últimos tempos tem ido de Ed Wood. Estou falando de sua conversa sobre o som.</p>
<p>Nolan constrói com a ajuda nada inspirada e toda exagerada do seu diretor de música uma sinfonia do caos audiovisual. Não são apenas as notas musicais tenebrosas, exageradas no ritmo e volume, mas também o que acontece ao mesmo tempo no filme. Os delírios, as alterações. Tente, por exemplo, defender um Oppenheimer pelado fazendo sexo com sua amante na sala onde está sendo julgado como uma tentativa de mostrar o que sua esposa está visualizando e vai começar a entender onde eu quero chegar quando critico o autismo severo de um dos diretores mais brilhantes que já passou por Hollywood.</p>
<p>Faz parte da experimentação do cineasta estes pequenos grandes tropeços em sua carreira. Porém, o que me incomoda é ele não ter enxergado o que nós admiramos em vários de seus trabalhos. É como se seus acertos fossem incidentais, assim como os erros. E isso preocupa quem gosta da sétima arte, onde Nolan é exemplo nas últimas duas décadas.</p>
<p>É triste dizer, mas faz falta o seu irmão no equilíbrio entre direção e roteiro. Gênios não trabalham sozinhos nem partem do nada. É uma pena que a pessoa que dedicou os últimos anos a entender isso do ponto de vista da ciência não  consiga enxergar isso em sua própria área.</p>
</section><hr/>

<span id="vinia-le-fruite-2021-frances" title="Vinia Le Fruité I.G.P. Pays d'Oc 2021"/></span>
<section>
<p class="title"><a href="2023-08.html#vinia-le-fruite-2021-frances">#</a> Vinia Le Fruité I.G.P. Pays d'Oc 2021</p>
<p class="note-title"><small>2023-08-17  <a href="wine.html">wine</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Eu abro vinho francês como quem não está afim de tomar vinho. Daí fico naquela de suquinho e talz. Este Vinia eu nem me lembro se tinha mais algum gosto do que uva estragada. O sommelier do Wine já deu a dica em suas notas: vinho elegante. Isso é sinônimo para bleh. Tem Carignan, Syrah e Grenache nesta garrafa (só para constar).</p>
</section><hr/>


<span id="eami" title="Eami"/></span>
<section>
<p class="title"><a href="2023-08.html#eami">#</a> Eami</p>
<p class="note-title"><small>2023-08-19  <a href="cinemaqui.html">cinemaqui</a> <a href="movies.html">movies</a> <a href="writting.html">writting</a> </small><a href="2023-08.html">^</a></p>

<p>Eami ganhou diversos prêmios mundo lá fora e é o representante do Paraguai para o Oscar desse ano. Então deve ser muito bom, né? Você sabe que não é assim que a banda toca.</p>
<p>Uma mescla de imagens enigmáticas e paradas com uma narração simbólica, quase hermenêutica, sobre eventos passados, o filme prefere assumir a narrativa do oprimido indígena, o que se torna para o espectador não-indígena e não-engajado nesse assunto, ou seja, qualquer desavisado que entrar na sala de cinema, uma história sobre coisa alguma. E pior: que dá vontade de dormir.</p>
<p>Pelo menos nisso o filme acerta, já que os delírios são sobre um passado longínquo, 30 anos atrás, sobre ou um massacre, ou uma invasão, ou a queima da floresta, habitat natural do povo retratado. Porém, diferente de trabalhos instigantes, este não te provoca para buscar conhecimento após a sessão.</p>
<p>O idioma e os costumes deste povo são extremamente primitivos. Indígenas do novo mundo são o último elo entre a civilização e o homem pré-histórico. Talvez por isso este mundo nos pareça tão estranho. Para alguns fascinante. Para o resto, nós, completamente estranho. Alienígena.</p>
<p>Entre este elo e o homem moderno infinitas disputas de terra e muito derramamento de sangue existiu e continua existindo até a configuração geográfica e política atual dos países. Assassinatos, escravidão, tortura, estupros, sabotagens e muitas outras ações pela sobrevivência dos povos existiu na história. Mas, por algum motivo, os indígenas ocupam uma posição especial quando se fala de algo que sofreram.</p>
<p>E não é o surgimento do cinema, este mecanismo de pausterização de dramas. Há várias outras histórias de opressão de outros povos onde entendemos a língua que está sendo falada. O drama consegue ser transmitido, mesmo que pelo próprio povo que massacrou o derrotado.</p>
<p>Talvez seja esse mito do bom selvagem misturado com políticas sociais e uma pitada de nascisismo geopolítico. Nós gostamos de nos sentir importantes ao falar sobre algo no sentido de denúncia, pois nos posicionamos como salvadores, ou parte da salvação. Nem que seja assistindo, dialogando sobre o filme ou expressando nossa opinião muito original e independente a respeito de concordarmos com tudo que a cineasta mostra. Este é o verdadeiro debate do século: só há um lado e é sempre o lado certo.</p>
<p>As imagens de Eima não fazem sentido. Suas trucagens com filtro de cor, luz e transições entre cenas , além de bregas, são o combustível que dá mais sono ainda. Nada do que você ver neste filme te salvará do sono eterno. Estamos fadados a acompanhar o drama indígena em nossos sonhos. Nosso único consolo é que o tormento acaba logo.</p>
</section><hr/>


<span id="blogawk" title="Finalmente blogawk"/></span>
<section>
<p class="title"><a href="2023-08.html#blogawk">#</a> Finalmente blogawk <a class="external" href="https://github.com/caloni/blog/blob/master/scripts/txt2blog.awk">[link]</a></p>
<p class="note-title"><small>2023-08-20  <a href="blogging.html">blogging</a> <a href="coding.html">coding</a> </small><a href="2023-08.html">^</a></p>

<p>Fiquei muito empolgado com a solução awk que converte meus posts para um epub "carregável" em um leitor de ebook e no computador e parti para usar a mesma estratégia em meu blog para abandonar dessa vez o Hugo, um renderizador de sites estáticos feito em golang extremamente rápido, mas que não está dando conta dos meus mais de 4000 posts.</p>
<p>O maior peso dessa conversão é o file system. A leitura e escrita de milhares de arquivos, mesmo que não seja feita nenhuma conversão, por si só já é a parte mais pesada. Sendo assim, adotei duas estratégias de otimização:</p>
<p>1. Usar um único arquivo de leitura.</p>
<p>Com isso eu consigo aplicar a leitura deste arquivo pelo script awk em um passo só. De quebra, as mudanças sistêmicas no blogue serão muito mais fáceis.</p>
<p>2. Usar um arquivo por mês na escrita.</p>
<p>Esse foi o maior economizador de tempo. Gerar 4000 novas entradas no file system do Windows estava custando caro, em torno de um minuto. Transformar isso em uns 300 arquivos fez a escrita levar de dois a três segundos!</p>
<p>A tradução do site para awk levou no total uns dois dias. A ideia foi copiar o HTML gerado pelo Hugo e fazer os mapeamentos de data, tags e estruturas de listagem no awk, que lida com isso através de seus arrays dinâmicos com muita facilidade e rapidez.</p>
<p>Um ponto de atenção aos novatos do awk que eu destacaria dessa experiência é sobre as variáveis. Exceto os argumentos de funções, todas as variáveis são globais, o que pode dar alguns pesadelos quando há mais de um uso do mesmo nome, especialmente quando há diferença entre tipos escalares e arrays. Se eu fosse fazer do zero novamente eu não economizaria na largura dos nomes e nos prefixos, como g_ para denotar as globais. Um truque muito bom do awk também é declarar variáveis da função como parâmetros que não são recebíveis pelo chamador. Há <a href="https://www.gnu.org/software/gawk/manual/gawk.html#Variable-Scope">uma convenção</a> de separar por espaços os parâmetros reais dos locais.</p>
<p>De resto, agora tenho a liberdade de renderizar meu blogue em questão de segundos. Aposentei a estrutura do Hugo e estou usando awk para gerar tanto o blogue quanto o ebook.</p>
<p>Não achei justo fazer benchmarks de comparação com o Hugo pelo motivo do file system já citado e também pelas diferentes estratégias adotadas. Pelo própria estrutura engessada e necessáriado Hugo em unir estrutura de arquivos fontes e estrutura final do saite eu sei que não seria viável continuar usando a ferramenta.</p>
<p>Além disso, awk me dará a liberdade que gostaria de indexar pesadamente meus textos com o poder dos arrays associativos de awk. Já conhecia eles do PHP, mas agora que conheci os do awk estou pensando seriamente em adotar para outros tipos de tratamento de texto. Talvez até use para minhas finanças pessoais.</p>
</section><hr/>


<span id="hstring" title="Explorando a HSTRING"/></span>
<section>
<p class="title"><a href="2023-08.html#hstring">#</a> Explorando a HSTRING <a class="external" href="https://learn.microsoft.com/en-us/windows/win32/api/winstring/">[link]</a></p>
<p class="note-title"><small>2023-08-21  <a href="coding.html">coding</a> <a href="reversing.html">reversing</a> </small><a href="2023-08.html">^</a></p>

<p>Estava me enveredando hoje nos bytes usados para montar e demonstar os argumentos de uma interface COM proxy da WinRT quando quis saber qual era o leiaute da nova string do Windows, a HSTRING, usada na WinRT e em todo o ecossistema dos Universal apps.</p>
<p>Bom, para quem sabe assembly básico, não há nada prático que fazer uma sessão simples de debugging chamando as funções da API. Inspirado na primeira sessão do livro <a href="posts.html?q=reversing">reversing</a>, fiz as chamadas básicas para obter o tamanho da string, o raw buffer, etc, e fui adentrando no disassembly de cada uma, obtendo as linhas-chave para montar a struct que representa uma HSTRING. Abaixo o código-fonte:</p>
<pre>
#include <winstring.h>
#include <string>
using namespace std;
int main()
{
    wstring str = L"my hstring";
    HSTRING hstr = NULL;
    HRESULT hr = WindowsCreateString(str.c_str(), (UINT32) str.size(), &hstr);
    if( SUCCEEDED( hr ) )
    {
        UINT32 hstrLen = WindowsGetStringLen(hstr);
        hstrLen = 0;
        PCWSTR rawHstr = WindowsGetStringRawBuffer(hstr, &hstrLen);
        BOOL isEmpty = WindowsIsStringEmpty(hstr);
        HSTRING hstr2 = NULL;
        hr = WindowsDuplicateString(hstr, &hstr2);
        if( SUCCEEDED(hr) )
        {
            hr = WindowsDeleteString(hstr2);
        }
        hr = WindowsDeleteString(hstr);
    }
    HSTRING_HEADER hstrHeader = {};
    HSTRING hstr3 = NULL;
    hr = WindowsCreateStringReference(str.c_str(), (UINT32) str.size(), &hstrHeader, &hstr3);
    if( SUCCEEDED( hr ) )
    {
        hr = WindowsDeleteString(hstr3);
    }
    return hr;
}</pre>
<p>Com isso fui fazendo as calls e encontrando os offsets pelas instruções referentes ao rcx, primeiro parâmetro passado em x64:</p>
<pre>
UINT32 hstrLen = WindowsGetStringLen(hstr);
00007FFC84D8BBE7  mov         eax,dword ptr [rcx+4]  
PCWSTR rawHstr = WindowsGetStringRawBuffer(hstr, &hstrLen);
00007FFC84D22345  mov         rax,qword ptr [rcx+10h]  
BOOL isEmpty = WindowsIsStringEmpty(hstr);
00007FFC84D23019  mov         edx,dword ptr [rcx+4]  
00007FFC84D2301C  test        edx,edx  
00007FFC84D2301E  sete        al  
hr = WindowsDuplicateString(hstr, &hstr2);
00007FFC84D1789A  lock inc    dword ptr [rcx+18h]
hr = WindowsDeleteString(hstr2);
00007FFC84D176A8  lock xadd   dword ptr [rcx+18h],eax
hr = WindowsCreateStringReference(...
layout:
0x0000009C0230F848  00000001</pre>
<p>E eis o resultado que cheguei:</p>
<pre>
struct HSTRING {
  BOOL Reference;     // +0x00
  UINT32 Lenght;      // +0x04
  UINT64 Unused2;
  PCWSTR RawString;   // +0x10
  UINT32 RefCounter;  // +0x18
};</pre>
<p>Para mais detalhes do uso dessa string dê uma olhada no ótimo <a href="https://devblogs.microsoft.com/oldnewthing/20160615-00/?p=93675">artigo de Raymond Chen</a>.</p>

</section><hr/>


<span id="repaginada-do-mes" title="Muitos animes, lugares e séries"/></span>
<section>
<p class="title"><a href="2023-08.html#repaginada-do-mes">#</a> Muitos animes, lugares e séries</p>
<p class="note-title"><small>2023-08-23  <a href="blogging.html">blogging</a> </small><a href="2023-08.html">^</a></p>

<p>A ideia de fazer um apanhado da semana como havia feito em um <a href="posts.html?q=repaginada-da-semana">post anterior</a> não se sustenta se eu deixo de escrever por um mês. Especialmente se a Sra. Mitiko inventa de assistir um milhão de animes. Além do mais, agora que não existe mais uma página por post e a indexação é feita por hashtags fica muito mais simples apenas ir encadeando post a post, como subseções pequenas de um escrito maior. Bom, dependendo do caso, claro. Algumas vezes é bom ligar os pontos (como irei fazer agora).</p>

</section><hr/>

<span style="float: left;">
 <a href="2023-07.html"><<</a>
 <a href="index.html">>></a>
</span>
</div>
</div>
</section>
<footer class="footer">
<div class="container">
<span style="float: right;"><i style="font-size: small;">Blogue do Caloni</i></span>
</div>
</footer>
</body>
</html>
